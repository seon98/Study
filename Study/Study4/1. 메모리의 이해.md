# 운영체제 메모리의 이해

## 1. 메모리란?

메모리(Memory)는 CPU가 직접 접근하여 데이터를 읽고 쓸 수 있는 공간으로, 프로그램 실행에 필요한 명령어와 데이터를 저장하는 장치입니다.

---

## 2. 메모리의 계층 구조 (Memory Hierarchy)

| 계층 | 종류 | 특징 | 속도 | 비용 | 용도 |
|------|------|------|------|------|------|
| 1 | 레지스터(Register) | CPU 내부의 임시 저장소 | 매우 빠름 | 매우 비쌈 | 연산 대상 임시 저장 |
| 2 | 캐시 메모리(Cache) | CPU와 RAM 사이의 버퍼 역할 | 빠름 | 비쌈 | 자주 쓰는 데이터 저장 |
| 3 | 주기억장치(Main Memory, RAM) | 실행 중인 프로그램과 데이터를 저장 | 중간 | 중간 | 현재 실행 중인 프로세스 저장 |
| 4 | 보조기억장치(HDD/SSD) | 비휘발성 대용량 저장소 | 느림 | 저렴 | 프로그램, OS, 데이터 영구 저장 |

---

## 3. 주기억장치(Main Memory)

- **RAM (Random Access Memory)**
  → 실행 중인 프로그램과 데이터를 저장. 전원이 꺼지면 데이터 사라짐.

- **ROM (Read Only Memory)**
  → 부팅 시 필수 정보 저장. 전원이 꺼져도 데이터 유지됨.

---

## 4. 메모리 관리 기법

### 4.1 연속 메모리 할당 (Contiguous Memory Allocation)

- 메모리를 연속된 공간으로 할당
- 단점: **단편화(External Fragmentation)** 발생
- 기법: First Fit / Best Fit / Worst Fit

### 4.2 페이징(Paging)

- 메모리를 **고정 크기 페이지**로 분할 (페이지: Page / 프레임: Frame)
- 논리주소 → 물리주소 매핑
- 장점: **단편화 해결**, 메모리 효율 ↑

### 4.3 세그멘테이션(Segmentation)

- 메모리를 **의미 단위(함수, 배열 등)**로 분할
- 가변 크기 블록으로 할당

---

## 5. 가상 메모리(Virtual Memory)

### 정의

- 실제 메모리(RAM)보다 큰 메모리를 **프로세스가 사용하는 것처럼** 보이게 하는 기술

### 주요 구성

- **페이지 테이블(Page Table)**
  → 논리 주소와 물리 주소를 매핑

- **스왑 공간(Swap Space)**
  → 실제 RAM이 부족할 경우, 디스크 공간을 임시 RAM처럼 사용

### 장점

- 더 많은 프로세스 실행 가능
- 프로세스 간 메모리 보호
- 프로그램 전체가 메모리에 안 떠도 실행 가능

---

## 6. 메모리 보호 기법

- **Base and Limit Register**: 프로세스의 메모리 범위 제한
- **Segmentation with Protection Bit**: 세그먼트별 접근 권한 제어
- **Paging with Access Rights**: 페이지별 읽기/쓰기 권한 설정

---

## 7. 페이지 교체 알고리즘

| 알고리즘 | 설명 |
|----------|------|
| FIFO | 가장 먼저 들어온 페이지를 교체 |
| LRU | 가장 오랫동안 사용되지 않은 페이지 교체 |
| Optimal | 앞으로 가장 오래 사용되지 않을 페이지를 교체 (이론적 최적) |
| Clock | LRU를 간단히 구현한 방식 (Reference Bit 사용) |

---

## 8. 메모리 단편화(Fragmentation)

| 종류 | 설명 | 예시 |
|------|------|------|
| 내부 단편화 | 고정 크기 블록 내 남은 공간 | 100KB 할당, 70KB 사용 |
| 외부 단편화 | 여러 공간이 비어있지만 연속된 공간 부족 | 30KB + 40KB → 70KB 불가 |

---

## 9. 스택(Stack)과 힙(Heap)

- **스택**: 함수 호출 시 지역 변수 저장, 컴파일 타임에 크기 결정
- **힙**: 동적 할당된 메모리 저장, 런타임에 크기 결정

---

## 10. 요약

| 항목 | 요약 |
|------|------|
| 메모리의 역할 | CPU가 데이터와 명령어를 저장·사용 |
| 주요 구분 | 레지스터, 캐시, RAM, HDD/SSD |
| 관리 기법 | 연속 할당, 페이징, 세그멘테이션 |
| 고급 기능 | 가상 메모리, 페이지 교체 알고리즘 |
| 보호 | 메모리 간 접근 보호 기법 |

---

## 참고

- [OS: Three Easy Pieces](https://pages.cs.wisc.edu/~remzi/OSTEP/)
- [위키독스 운영체제](https://wikidocs.net/book/7031)
- [GeeksforGeeks: Memory Management in OS](https://www.geeksforgeeks.org/memory-management-in-operating-system/)
